(function(e){function t(t){for(var n,o,u=t[0],s=t[1],i=t[2],l=0,p=[];l<u.length;l++)o=u[l],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&p.push(c[o][0]),c[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,i||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,o=1;o<r.length;o++){var u=r[o];0!==c[u]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},o={app:0},c={app:0},a=[];function u(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-1ae213c2":"392b30c9","chunk-34b40cef":"078ec6b9"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r={"chunk-1ae213c2":1,"chunk-34b40cef":1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=new Promise((function(t,r){for(var n="css/"+({}[e]||e)+"."+{"chunk-1ae213c2":"e386d2b5","chunk-34b40cef":"11d7658d"}[e]+".css",c=s.p+n,a=document.getElementsByTagName("link"),u=0;u<a.length;u++){var i=a[u],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===n||l===c))return t()}var p=document.getElementsByTagName("style");for(u=0;u<p.length;u++){i=p[u],l=i.getAttribute("data-href");if(l===n||l===c)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||c,a=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=n,delete o[e],d.parentNode.removeChild(d),r(a)},d.href=c;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){o[e]=0})));var n=c[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,r){n=c[e]=[t,r]}));t.push(n[2]=a);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=u(e);var p=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(d);var r=c[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",p.name="ChunkLoadError",p.type=n,p.request=o,r[1](p)}c[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var p=0;p<i.length;p++)t(i[p]);var d=l;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"3df0":function(e,t,r){},"3f55":function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return d}));var n=r("1da1"),o=(r("96cf"),r("bc3a")),c=r.n(o);function a(e,t,r){localStorage.setItem("user",JSON.stringify({accessToken:e,refreshToken:t,expires:r}))}function u(e){return s.apply(this,arguments)}function s(){return s=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c()({method:"post",url:"https://api.bo.aa44.ru/api/Auth/register",data:{lastName:t.lastName,firstName:t.firstName,patronymic:t.patronymic,userName:t.userName,password:t.password,confirmPassword:t.confirmPassword,phoneNumber:t.phoneNumber,email:t.email}});case 3:return r=e.sent,a(r.data.accessToken,r.data.refreshToken,r.data.expires),e.abrupt("return",r);case 8:return e.prev=8,e.t0=e["catch"](0),console.log(e.t0),e.abrupt("return",0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),s.apply(this,arguments)}function i(e,t){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c()({method:"post",url:"https://api.bo.aa44.ru/api/Auth/login",data:{userName:t,password:r}});case 3:return n=e.sent,a(n.data.accessToken,n.data.refreshToken,n.data.expires),e.abrupt("return",n);case 8:return e.prev=8,e.t0=e["catch"](0),console.log(e.t0),e.abrupt("return",0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),l.apply(this,arguments)}function p(){localStorage.removeItem("user")}function d(){return f.apply(this,arguments)}function f(){return f=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("user")).refreshToken,r="https://api.bo.aa44.ru/api/Auth/tokens/"+t+"/refresh",e.prev=2,e.next=5,c()({method:"post",url:r});case 5:return n=e.sent,a(n.data.accessToken,n.data.refreshToken,n.data.expires),console.log("token refreshed"),e.abrupt("return",n);case 11:return e.prev=11,e.t0=e["catch"](2),console.log(e.t0),e.abrupt("return",0);case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),f.apply(this,arguments)}},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23");function o(e,t){var r=Object(n["v"])("router-view");return Object(n["p"])(),Object(n["d"])(r)}r("78a2");const c={};c.render=o;var a=c,u=(r("d3b7"),r("3ca3"),r("ddb0"),r("6c02"));function s(e,t,r,o,c,a){var u=Object(n["v"])("v-header"),s=Object(n["v"])("v-countries");return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["g"])(u),Object(n["g"])(s)],64)}var i={class:"v-header"},l=Object(n["g"])("div",{class:"v-header__main"},null,-1),p={class:"v-header__logout"};function d(e,t,r,o,c,a){var u=Object(n["v"])("v-logout");return Object(n["p"])(),Object(n["d"])("header",i,[l,Object(n["g"])("div",p,[Object(n["g"])(u)])])}function f(e,t,r,o,c,a){return c.loggedIn?(Object(n["p"])(),Object(n["d"])("div",{key:0,class:"v-logout",onClick:t[1]||(t[1]=function(){return a.logoutUser&&a.logoutUser.apply(a,arguments)})}," Выйти ")):Object(n["e"])("",!0)}var h=r("3f55"),b={name:"v-logout",data:function(){return{loggedIn:!!JSON.parse(localStorage.getItem("user"))}},methods:{logoutUser:function(){Object(h["b"])(),this.$router.push("/login")}}};r("5c04");b.render=f;var v=b,g={name:"v-header",components:{vLogout:v}};r("7951");g.render=d;var m=g,O=(r("b0c0"),{class:"v-countries"}),j=Object(n["g"])("div",{class:"v-countries__country"},[Object(n["g"])("div",{class:"v-countries__column"},"Name"),Object(n["g"])("div",{class:"v-countries__column"},"CurrencyCode"),Object(n["g"])("div",{class:"v-countries__column"},"ShortName")],-1),y={class:"v-countries__column"},k={class:"v-countries__column"},w={class:"v-countries__column"};function _(e,t,r,o,c,a){var u=Object(n["v"])("v-modal");return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["g"])("div",O,[j,(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["t"])(c.countriesToShow,(function(e){return Object(n["p"])(),Object(n["d"])("div",{class:"v-countries__country",key:e.id,onClick:function(t){return a.showCountry(e)}},[Object(n["g"])("div",y,Object(n["x"])(e.name),1),Object(n["g"])("div",k,Object(n["x"])(e.currency.currencyCode),1),Object(n["g"])("div",w,Object(n["x"])(e.currency.shortName),1)],8,["onClick"])})),128)),Object(n["g"])("div",null,[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["t"])(c.pages,(function(e){return Object(n["p"])(),Object(n["d"])("span",{class:["v-countries__page",{"v-countries__page--current":e==c.page}],key:e,onClick:function(t){return a.openPage(e)}},Object(n["x"])(e),11,["onClick"])})),128))])]),c.modalVisible?(Object(n["p"])(),Object(n["d"])(u,{key:0,onCloseModal:a.closeModal},{default:Object(n["B"])((function(){return[Object(n["g"])("div",null,Object(n["x"])(c.chosenCountry.name),1),Object(n["g"])("div",null,Object(n["x"])(c.chosenCountry.currency.currencyCode),1),Object(n["g"])("div",null,Object(n["x"])(c.chosenCountry.currency.shortName),1)]})),_:1},8,["onCloseModal"])):Object(n["e"])("",!0)],64)}var x=r("1da1"),C=(r("96cf"),r("bc3a")),S=r.n(C),N={class:"v-modal__wrapper",ref:"v-modal__wrapper"},T={class:"v-modal"};function P(e,t,r,o,c,a){return Object(n["p"])(),Object(n["d"])("div",N,[Object(n["g"])("div",T,[Object(n["g"])("span",{class:"v-modal__close",onClick:t[1]||(t[1]=function(){return a.closeModal&&a.closeModal.apply(a,arguments)})},"Закрыть"),Object(n["u"])(e.$slots,"default")])],512)}var M={name:"v-modal",mounted:function(){var e=this;document.addEventListener("click",(function(t){t.target==e.$refs["v-modal__wrapper"]&&e.closeModal()}))},methods:{closeModal:function(){this.$emit("closeModal")}}};r("d029");M.render=P;var E=M,A={name:"v-countries",components:{vModal:E},data:function(){return{countries:[],modalVisible:!1,chosenCountry:{},page:1,perPage:5,pages:0,countriesToShow:[]}},mounted:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCountries();case 2:e.openPage(e.page);case 3:case"end":return t.stop()}}),t)})))()},methods:{getCountries:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=JSON.parse(localStorage.getItem("user")),r){t.next=4;break}return e.$router.push("/login"),t.abrupt("return",0);case 4:return t.prev=4,t.next=7,S()({method:"get",url:"https://api.bo.aa44.ru/api/Countries",headers:{Authorization:"Bearer "+r.accessToken}});case 7:n=t.sent,e.countries=n.data,e.pages=Math.ceil(e.countries.count/e.perPage),t.next=23;break;case 12:return t.prev=12,t.t0=t["catch"](4),console.log(t.t0),t.next=17,Object(h["c"])();case 17:if(!t.sent){t.next=21;break}e.getCountries(),t.next=23;break;case 21:Object(h["b"])(),e.$router.push("/login");case 23:case"end":return t.stop()}}),t,null,[[4,12]])})))()},showCountry:function(e){this.modalVisible=!0,this.chosenCountry=e},closeModal:function(){this.modalVisible=!1,this.chosenCountry={}},openPage:function(e){this.countriesToShow=[],this.page=e;for(var t=this.perPage*(e-1),r=0;r<this.perPage;r++){if(t>=this.countries.count)break;this.countriesToShow.push(this.countries.data[t++])}}}};r("5864");A.render=_;var I=A,R={name:"home",components:{vHeader:m,vCountries:I}};R.render=s;var J=R,L=[{path:"/",name:"home-page",component:J},{path:"/login",name:"login-page",beforeEnter:function(e,t,r){JSON.parse(localStorage.getItem("user"))?r("/"):r()},component:function(){return r.e("chunk-34b40cef").then(r.bind(null,"7d13"))}},{path:"/registration",name:"registration-page",beforeEnter:function(e,t,r){JSON.parse(localStorage.getItem("user"))?r("/"):r()},component:function(){return r.e("chunk-1ae213c2").then(r.bind(null,"6186"))}}],$=Object(u["a"])({history:Object(u["b"])("/"),routes:L}),B=$;Object(n["c"])(a).use(B).mount("#app")},5864:function(e,t,r){"use strict";r("97ae")},"5c04":function(e,t,r){"use strict";r("6425")},6425:function(e,t,r){},"78a2":function(e,t,r){"use strict";r("a910")},7951:function(e,t,r){"use strict";r("3df0")},"97ae":function(e,t,r){},a910:function(e,t,r){},b2ed:function(e,t,r){},d029:function(e,t,r){"use strict";r("b2ed")}});
//# sourceMappingURL=app.d8b71d20.js.map